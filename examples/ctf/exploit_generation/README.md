# Exploit Generation Example

This example demonstrates how to use Manticore to automatically generate exploits from crashes.

## Overview

The example includes a vulnerable binary (`bof`) with a classic buffer overflow that allows control flow hijacking. The scripts demonstrate:

1. **Tracing concrete execution** to identify crash points
2. **Using symbolic execution** to generate inputs that redirect execution
3. **Converting crashes into working exploits**

## Files

- `bof` - Vulnerable x86 Linux binary with buffer overflow
- `bof.c` - Source code of the vulnerable program
- `record_trace.py` - Records execution trace to identify crash
- `crash_analysis.py` - Generates exploit from crash

## The Vulnerable Program

The binary contains a buffer overflow in the `vuln()` function:

```c
typedef struct {
    char buf[4];
    void (*f)();
} Some_struct;

void vuln(char *src) {
    Some_struct st;
    st.f = nothing;
    strcpy(st.buf, src); // buffer overflow
    st.f();
}
```

The overflow allows overwriting the function pointer `f` to redirect execution.

## Usage

### 1. Record the crash:

```bash
python record_trace.py
```

This will trace execution with input `AAAAAAAAAAAAAAAAAAAAAAA` and identify the crash point.

### 2. Generate exploit:

```bash
python crash_analysis.py
```

This performs:
- Concrete execution to record the path to crash
- Symbolic execution following that path
- Constraint solving to redirect execution to `call_me()`

### 3. Manual usage:

```bash
python crash_analysis.py ./bof -- AAAAAAAAAAAAAAAAAAAAAAA -- +++++++++++++++++++++++
```

## Expected Output

The analysis will generate an input like:
```
\x41\x01\x01\x01\x7c\x88\x04\x08\x01\x01\x01\x01...
```

This input overwrites the function pointer to redirect execution to `call_me()`.

## Educational Value

This example teaches:
- How crashes can be automatically analyzed
- Path-guided symbolic execution
- Constraint solving for exploit generation
- Combining concrete and symbolic execution

## Technical Details

- **Architecture**: x86 (32-bit)
- **Vulnerability**: Stack buffer overflow
- **Exploit**: Function pointer overwrite
- **Technique**: Hybrid concrete/symbolic execution